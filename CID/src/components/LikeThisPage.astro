---
interface Props {}
---

<like-this-page>
  <div class="row">
    <span>Var denne siden nyttig?</span>
    <button class="like">👍</button>
    <button class="dislike">👎</button>
  </div>
  <p class="thanks" hidden="true">Takk for tilbakemelding!</p>
</like-this-page>

<!-- Datadog Logging -->
<script src="https://www.datadoghq-browser-agent.com/datadog-logs-us.js"></script>
<script>
  // Extend the Window interface to include DD_LOGS
  interface Window {
    DD_LOGS?: {
      init: (options: any) => void;
      logger: {
        log: (message: string, context: any) => void;
      };
    };
  }

  class LikeThisPage extends HTMLElement {
    constructor() {
      super();

      // Initialize Datadog Logging
      if (window.DD_LOGS) {
        window.DD_LOGS.init({
          clientToken: 'pub2490c82193d6cd371c7bf1b1e443cfbf', 
          site: 'datadoghq.com',
          forwardErrorsToLogs: true,
          sampleRate: 100,
        });
      }

      const likeButton = this.querySelector('button.like') as HTMLButtonElement;
      if (likeButton == undefined) return;
      const dislikeButton = this.querySelector('button.dislike') as HTMLButtonElement;
      if (dislikeButton == undefined) return;
      const thanksMessage = this.querySelector('p.thanks') as HTMLParagraphElement;
      if (thanksMessage == undefined) return;

      function disableButtons() {
        likeButton.disabled = true;
        dislikeButton.disabled = true;

        thanksMessage.hidden = false;
      }

      likeButton.addEventListener('click', () => {
        if (window.DD_LOGS) {
          window.DD_LOGS.logger.log('like', {
            event_category: 'Like',
            event_label: 'Liked the page',
          });
        }

        disableButtons();
      });

      dislikeButton.addEventListener('click', () => {
        if (window.DD_LOGS) {
          window.DD_LOGS.logger.log('dislike', {
            event_category: 'Dislike',
            event_label: 'Disliked the page',
          });
        }

        disableButtons();
      });
    }
  }

  customElements.define('like-this-page', LikeThisPage);
</script>

<style>
  .row {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1.2rem;
  }

  button {
    font-size: 1.2rem;
    aspect-ratio: 1/1;
    width: 2rem;
    height: 2rem;
    margin-top: 0 !important;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .thanks {
    text-align: center;
  }
</style>
